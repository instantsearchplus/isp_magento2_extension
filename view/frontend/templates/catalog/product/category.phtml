<?php
$ispBlock = $this->getLayout()
    ->createBlock('Autocompleteplus\Autosuggest\Block\SearchResult\ListProduct');
?>
<?php if(!$ispBlock->getSmnV2($ispBlock->getStoreId())): ?>
    <div id="isp_search_result_page"></div>
    <script src="https://acp-magento.appspot.com/js/search_result_loading_page.js?smart_navigation=1&isp_platform=magento&UUID=<?= /* @noEscape */ $ispBlock->getApiUUID();?>&store_id=<?= /* @noEscape */ $ispBlock->getStoreId(); ?>"></script>
<?php else: ?>
    <?php
        $categoryId = $this->getLayer()->getCurrentCategory()->getId();
        try {
            $cv = $ispBlock->getCustomValues($ispBlock->getStoreId());
            $cv_j = json_decode($cv);
        } catch (Exception $e) {
            $cv_j = array(
                'config'=>'',
                'editor_css'=>''
            );
        }
    ?>
    <!---
    Auto-generated by Fast Simon.
    DO NOT EDIT this as this file can be re-written at any time.
    --->

    <div id="fast-config" style="display: none"><?= $cv_j['config']; ?></div>
    <style id="fast-serp-css"><?= $cv_j['editor_css']; ?></style>
    <script class="fast-simon-script">
        var STORE_UUID = "<?= $ispBlock->getApiUUID();?>";
        var STORE_ID = Number("<?= $ispBlock->getStoreId();?>");
        var FAST_SEARCH_HANDLE = "instantsearchplus/result";
        var CATEGORY_ID = "<?= $categoryId; ?>";
    </script>
    <div id="fast-simon-serp-app" style="display:block;color: initial;background: initial"></div>
    <script>
        var script = document.createElement("script");
        script.src = `https://fastsimon-grid.akamaized.net/init.min.js?v=${Date.now()}`;
        document.body.appendChild(script);
    </script>
<?php endif;?>
